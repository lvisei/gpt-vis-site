"use strict";(self.webpackChunk_antv_gpt_vis=self.webpackChunk_antv_gpt_vis||[]).push([[9010],{25349:function(c,t,n){var r;n.r(t),n.d(t,{demos:function(){return h}});var I=n(90228),d=n.n(I),f=n(87999),m=n.n(f),a=n(75271),p=n(18158),g=n(16773),h={"chartcoderender-demo-common":{component:a.memo(a.lazy(function(){return n.e(4589).then(n.bind(n,51698))})),asset:{type:"BLOCK",id:"chartcoderender-demo-common",refAtomIds:["ChartCodeRender"],dependencies:{"index.tsx":{type:"FILE",value:n(23261).Z},"@antv/gpt-vis":{type:"NPM",value:"0.2.2"},react:{type:"NPM",value:"18.3.1"}},entry:"index.tsx"},context:{"@antv/gpt-vis":p,react:r||(r=n.t(a,2))},renderOpts:{compile:function(){var l=m()(d()().mark(function s(){var o,i=arguments;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(1390).then(n.bind(n,81390));case 2:return e.abrupt("return",(o=e.sent).default.apply(o,i));case 3:case"end":return e.stop()}},s)}));function u(){return l.apply(this,arguments)}return u}()}},"chartcoderender-demo-default":{component:a.memo(a.lazy(function(){return n.e(4589).then(n.bind(n,15463))})),asset:{type:"BLOCK",id:"chartcoderender-demo-default",refAtomIds:["ChartCodeRender"],dependencies:{"index.tsx":{type:"FILE",value:n(15979).Z},"@antv/gpt-vis":{type:"NPM",value:"0.2.2"},react:{type:"NPM",value:"18.3.1"}},entry:"index.tsx"},context:{"@antv/gpt-vis":p,react:r||(r=n.t(a,2))},renderOpts:{compile:function(){var l=m()(d()().mark(function s(){var o,i=arguments;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(1390).then(n.bind(n,81390));case 2:return e.abrupt("return",(o=e.sent).default.apply(o,i));case 3:case"end":return e.stop()}},s)}));function u(){return l.apply(this,arguments)}return u}()}},"chartcoderender-demo-stream":{component:a.memo(a.lazy(function(){return n.e(4589).then(n.bind(n,45345))})),asset:{type:"BLOCK",id:"chartcoderender-demo-stream",refAtomIds:["ChartCodeRender"],dependencies:{"index.tsx":{type:"FILE",value:n(20182).Z},"@ant-design/x":{type:"NPM",value:"1.0.0"},"@antv/gpt-vis":{type:"NPM",value:"0.2.2"},react:{type:"NPM",value:"18.3.1"}},entry:"index.tsx"},context:{"@ant-design/x":g,"@antv/gpt-vis":p,react:r||(r=n.t(a,2))},renderOpts:{compile:function(){var l=m()(d()().mark(function s(){var o,i=arguments;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(1390).then(n.bind(n,81390));case 2:return e.abrupt("return",(o=e.sent).default.apply(o,i));case 3:case"end":return e.stop()}},s)}));function u(){return l.apply(this,arguments)}return u}()}},"chartcoderender-demo-extra":{component:a.memo(a.lazy(function(){return n.e(4589).then(n.bind(n,76448))})),asset:{type:"BLOCK",id:"chartcoderender-demo-extra",refAtomIds:["ChartCodeRender"],dependencies:{"index.tsx":{type:"FILE",value:n(73072).Z},"@antv/gpt-vis":{type:"NPM",value:"0.2.2"},react:{type:"NPM",value:"18.3.1"}},entry:"index.tsx"},context:{"@antv/gpt-vis":p,react:r||(r=n.t(a,2))},renderOpts:{compile:function(){var l=m()(d()().mark(function s(){var o,i=arguments;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(1390).then(n.bind(n,81390));case 2:return e.abrupt("return",(o=e.sent).default.apply(o,i));case 3:case"end":return e.stop()}},s)}));function u(){return l.apply(this,arguments)}return u}()}}}},76214:function(c,t,n){n.r(t),n.d(t,{texts:function(){return r}});const r=[{value:"\u81EA\u5B9A\u4E49\u62D3\u5C55 Markdown \u4EE3\u7801\u5757\u6E32\u67D3\uFF0C\u5C06\u4EE3\u7801\u5757\u81EA\u5B9A\u4E49\u53EF\u89C6\u5316\u3002",paraId:0,tocIndex:0},{value:`\u8FD9\u662F\u4E00\u6761\u8B66\u544A\u4FE1\u606F
`,paraId:1},{value:"withChartCode",paraId:1},{value:"\u3001",paraId:1},{value:"withDefaultChartCode",paraId:1},{value:" \u65B9\u6CD5\u4E0D\u8981\u76F4\u63A5\u653E\u5165\u51FD\u6570\u5185\u90E8\uFF0C\u907F\u514D\u91CD\u590D\u6E32\u67D3\u9020\u6210\u6296\u52A8\u95EE\u9898\uFF01\uFF01\uFF01\u5982\u9700\u653E\u5165\u51FD\u6570\u5185\u90E8\uFF0C\u7528 ",paraId:1},{value:"useMemo",paraId:1},{value:" \u7F13\u5B58\u4E00\u4E0B\u3002",paraId:1},{value:"withDefaultChartCode",paraId:2,tocIndex:2},{value:"\u5305\u542B\u4E86",paraId:2,tocIndex:2},{value:"\u9ED8\u8BA4\u7684\u56FE\u8868",paraId:2,tocIndex:2},{value:"\uFF0C\u63A5\u5165\u7B80\u5355",paraId:2,tocIndex:2},{value:"\u5C5E\u6027",paraId:3,tocIndex:6},{value:"\u7C7B\u578B",paraId:3,tocIndex:6},{value:"\u662F\u5426\u5FC5\u4F20",paraId:3,tocIndex:6},{value:"\u9ED8\u8BA4\u503C",paraId:3,tocIndex:6},{value:"\u8BF4\u660E",paraId:3,tocIndex:6},{value:"components",paraId:3,tocIndex:6},{value:"ChartComponents",paraId:3,tocIndex:6},{value:"\u5426",paraId:3,tocIndex:6},{value:"-",paraId:3,tocIndex:6},{value:"\u8981\u989D\u5916\u52A0\u8F7D\u7684\u56FE\u8868\u7EC4\u4EF6",paraId:3,tocIndex:6},{value:"languageRenderers",paraId:3,tocIndex:6},{value:"LanguageRenderers",paraId:3,tocIndex:6},{value:"\u5426",paraId:3,tocIndex:6},{value:"-",paraId:3,tocIndex:6},{value:"\u81EA\u5B9A\u4E49\u5176\u5B83\u8BED\u8A00\u4EE3\u7801\u5757\u6E32\u67D3\u5668",paraId:3,tocIndex:6},{value:"defaultRenderer",paraId:3,tocIndex:6},{value:"CodeRenderer",paraId:3,tocIndex:6},{value:"\u5426",paraId:3,tocIndex:6},{value:"-",paraId:3,tocIndex:6},{value:"\u9ED8\u8BA4\u7684\u4EE3\u7801\u6E32\u67D3\u5668",paraId:3,tocIndex:6},{value:"debug",paraId:3,tocIndex:6},{value:"boolean",paraId:3,tocIndex:6},{value:"\u5426",paraId:3,tocIndex:6},{value:"false",paraId:3,tocIndex:6},{value:"\u6253\u5F00\u8C03\u8BD5\u65E5\u5FD7",paraId:3,tocIndex:6},{value:"loadingTimeout",paraId:3,tocIndex:6},{value:"number",paraId:3,tocIndex:6},{value:"\u5426",paraId:3,tocIndex:6},{value:"-",paraId:3,tocIndex:6},{value:"\u8BBE\u7F6E loading \u52A8\u753B\u7684\u8D85\u65F6\u65F6\u95F4\uFF0C\u9ED8\u8BA4\u4E3A 5s",paraId:3,tocIndex:6},{value:"style",paraId:3,tocIndex:6},{value:"React.CSSProperties",paraId:3,tocIndex:6},{value:"\u5426",paraId:3,tocIndex:6},{value:"-",paraId:3,tocIndex:6},{value:"\u56FE\u8868\u6837\u5F0F\uFF0C\u914D\u7F6E\u5BB9\u5668\u6837\u5F0F",paraId:3,tocIndex:6}]},23261:function(c,t){t.Z=`import { ChartType, Column, GPTVisLite, withChartCode } from '@antv/gpt-vis';
import React from 'react';

const markdownContent = \`
\\\`\\\`\\\`vis-chart
{
  "type": "column",
  "data": [
    { "category": "\u7B2C\u4E00\u4EA7\u4E1A", "value": 7200.0 },
    { "category": "\u7B2C\u4E8C\u4EA7\u4E1A", "value": 36600.0 },
    { "category": "\u7B2C\u4E09\u4EA7\u4E1A" ,"value": 41000.0 },
    { "category": "\u7B2C\u56DB\u4EA7\u4E1A" ,"value": 21000.0 },
    { "category": "\u5176\u4ED6\u4EA7\u4E1A" ,"value": 81000.0 }
  ]
}
\\\`\\\`\\\`
\`;

// \u81EA\u5B9A\u4E49\u4EE3\u7801\u5757\u6E32\u67D3\u7EC4\u4EF6\uFF0CNOTE: withChartCode \u4E0D\u8981\u76F4\u63A5\u653E\u5165\u51FD\u6570\u5185\u90E8\uFF0C\u907F\u514D\u91CD\u590D\u6E32\u67D3\u6296\u52A8\u95EE\u9898\uFF01\uFF01\uFF01
const CodeComponent = withChartCode({
  components: { [ChartType.Column]: Column },
  debug: true,
});

export default () => {
  return (
    <GPTVisLite
      components={{
        code: CodeComponent,
      }}
    >
      {markdownContent}
    </GPTVisLite>
  );
};
`},15979:function(c,t){t.Z=`import { GPTVisLite, withDefaultChartCode } from '@antv/gpt-vis';
import React from 'react';

const commonString = \`
\u5F53\u7136\u53EF\u4EE5\uFF01\u5728 JavaScript \u4E2D\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\u52A0\u6CD5\u8FD0\u7B97\u7B26 \\\`+\\\` \u6765\u5B9E\u73B0\u4E24\u4E2A\u6570\u5B57\u7684\u76F8\u52A0\u3002\u4EE5\u4E0B\u662F\u4E00\u4E2A\u7B80\u5355\u7684\u51FD\u6570\uFF0C\u5B83\u63A5\u53D7\u4E24\u4E2A\u53C2\u6570 \\\`a\\\` \u548C \\\`b\\\`,\u5E76\u8FD4\u56DE\u5B83\u4EEC\u7684\u548C\uFF1A

\\\`\\\`\\\`javascript\\nfunction add(a, b) {\\n  return a + b;\\n}\\n\\n// \u793A\u4F8B\u7528\u6CD5\\nconst result = add(3, 4);\\nconsole.log(result); // \u8F93\u51FA\uFF1A7\\n\\\`\\\`\\\`\\n\\n\u5728\u8FD9\u4E2A\u793A\u4F8B\u4E2D\uFF0C\u6211\u4EEC\u5B9A\u4E49\u4E86\u4E00\u4E2A\u540D\u4E3A \\\`add\\\` \u7684\u51FD\u6570\uFF0C\u5B83\u63A5\u53D7\u4E24\u4E2A\u53C2\u6570 \\\`a\\\` \u548C \\\`b\\\`\u3002\u51FD\u6570\u7684\u4E3B\u4F53\u53EA\u6709\u4E00\u884C\u4EE3\u7801\uFF0C\u4F7F\u7528\u52A0\u6CD5\u8FD0\u7B97\u7B26 \\\`+\\\` \u5C06 \\\`a\\\` \u548C \\\`b\\\` \u76F8\u52A0\uFF0C\u5E76\u8FD4\u56DE\u7ED3\u679C\u3002\\n\\n\u7136\u540E\uFF0C\u6211\u4EEC\u8C03\u7528
\`;

const markdownContent = \`
\\\`\\\`\\\`vis-chart
{
  "type": "pie",
  "data": [
    { "category": "\u5206\u7C7B\u4E00", "value": 27 },
    { "category": "\u5206\u7C7B\u4E8C", "value": 25 },
    { "category": "\u5206\u7C7B\u4E09", "value": 18 },
    { "category": "\u5206\u7C7B\u56DB", "value": 15 },
    { "category": "\u5206\u7C7B\u4E94", "value": 10 },
    { "category": "\u5176\u4ED6", "value": 5 }
  ]
}
\\\`\\\`\\\`
\`;

// \u81EA\u5B9A\u4E49\u4EE3\u7801\u5757\u6E32\u67D3\u7EC4\u4EF6\uFF0CNOTE: withDefaultChartCode \u4E0D\u8981\u76F4\u63A5\u653E\u5165\u51FD\u6570\u5185\u90E8\uFF0C\u907F\u514D\u91CD\u590D\u6E32\u67D3\u6296\u52A8\u95EE\u9898\uFF01\uFF01\uFF01
const CodeComponent = withDefaultChartCode({
  debug: true,
});

export default () => (
  <div>
    <GPTVisLite>{commonString}</GPTVisLite>
    <GPTVisLite
      components={{
        code: CodeComponent,
      }}
    >
      {markdownContent}
    </GPTVisLite>
  </div>
);
`},73072:function(c,t){t.Z=`import type { CodeBlockComponent } from '@antv/gpt-vis';
import { GPTVisLite, withDefaultChartCode } from '@antv/gpt-vis';
import React from 'react';

/**
 * \u81EA\u5B9A\u4E49\u4EE3\u7801\u5757\u6E32\u67D3\u5668
 */
const MyUIRenderer: CodeBlockComponent = ({ children }) => {
  return <div style={{ backgroundColor: '#f0f0f0', padding: '10px' }}>{children}</div>;
};

const markdownContent = \`
\\\`\\\`\\\`my-ui
my data ...
\\\`\\\`\\\`

\\\`\\\`\\\`vis-chart
{
   "type": "pin-map",
   "data": [
    { "label": "\u6768\u6885\u5CAD", "longitude": 120.118362, "latitude": 30.217175 },
    { "label": "\u7406\u5B89\u5BFA", "longitude": 120.112958, "latitude": 30.207319 },
    { "label": "\u4E5D\u6EAA\u70DF\u6811", "longitude": 120.11335, "latitude": 30.202395 },
    { "label": "\u98DE\u6765\u5CF0", "longitude": 120.100549, "latitude": 30.236875 },
    { "label": "\u7075\u9690\u5BFA", "longitude": 120.101406, "latitude": 30.240826 },
    { "label": "\u5929\u7AFA\u4E09\u5BFA", "longitude": 120.105337, "latitude": 30.236818 },
    { "label": "\u676D\u5DDE\u690D\u7269\u56ED", "longitude": 120.116979, "latitude": 30.252876 },
    { "label": "\u676D\u5DDE\u82B1\u5703", "longitude": 120.127654, "latitude": 30.245663 },
    { "label": "\u82CF\u5824", "longitude": 120.135764, "latitude": 30.251448 },
    { "label": "\u864E\u8DD1\u516C\u56ED", "longitude": 120.130095, "latitude": 30.207505 },
    { "label": "\u7389\u7687\u98DE\u4E91", "longitude": 120.145323, "latitude": 30.214993 },
    { "label": "\u957F\u6865\u516C\u56ED", "longitude": 120.155057, "latitude": 30.232985 }
  ]
}
\\\`\\\`\\\`
\`;

// \u81EA\u5B9A\u4E49\u4EE3\u7801\u5757\u6E32\u67D3\u7EC4\u4EF6\uFF0CNOTE: withDefaultChartCode \u4E0D\u8981\u76F4\u63A5\u653E\u5165\u51FD\u6570\u5185\u90E8\uFF0C\u907F\u514D\u91CD\u590D\u6E32\u67D3\u6296\u52A8\u95EE\u9898\uFF01\uFF01\uFF01
const CodeComponent = withDefaultChartCode({
  languageRenderers: {
    'my-ui': MyUIRenderer,
  },
});

export default () => (
  <div>
    <GPTVisLite
      components={{
        code: CodeComponent,
      }}
    >
      {markdownContent}
    </GPTVisLite>
  </div>
);
`},20182:function(c,t){t.Z=`import { Bubble, type BubbleProps } from '@ant-design/x';
import { ChartType, Column, GPTVisLite, withChartCode } from '@antv/gpt-vis';
import React, { useEffect, useRef, useState } from 'react';

const markdownContent = \`
\u5F53\u7136\u4E86\uFF0C\u4EE5\u4E0B\u662F\u4E3A\u4F60\u7ED8\u5236\u7684\u4E00\u4E2A\u67F1\u72B6\u56FE

\\\`\\\`\\\`vis-chart
{
  "type": "column",
  "data": [
    { "category": "\u7B2C\u4E00\u4EA7\u4E1A", "value": 7200.0 },
    { "category": "\u7B2C\u4E8C\u4EA7\u4E1A", "value": 36600.0 },
    { "category": "\u7B2C\u4E09\u4EA7\u4E1A" ,"value": 41000.0 }
  ]
}
\\\`\\\`\\\`
\`;

const bgStyle = {
  display: 'grid',
  gridGap: '20px 0',
  background: '#f7f7f7',
  padding: 20,
  borderRadius: 8,
};

// \u81EA\u5B9A\u4E49\u4EE3\u7801\u5757\u6E32\u67D3\u7EC4\u4EF6\uFF0CNOTE: withChartCode \u4E0D\u8981\u76F4\u63A5\u653E\u5165\u51FD\u6570\u5185\u90E8\uFF0C\u907F\u514D\u91CD\u590D\u6E32\u67D3\u6296\u52A8\u95EE\u9898\uFF01\uFF01\uFF01
const CodeComponent = withChartCode({
  components: { [ChartType.Column]: Column },
  loadingTimeout: 3000,
});

const RenderMarkdown: BubbleProps['messageRender'] = (content) => (
  <GPTVisLite components={{ code: CodeComponent }}>{content}</GPTVisLite>
);

const useStreamText = () => {
  const [text, setText] = useState('');
  const nowTextRef = useRef('');
  const timerRef = useRef<any>(null);

  /** \u6A21\u62DF\u6D41\u5F0F\u8F93\u51FAmarkdownContent */
  const streamOutput = () => {
    timerRef.current = setInterval(() => {
      const step = parseInt((Math.random() * 10).toString(), 20);
      const nowText =
        nowTextRef.current +
        markdownContent.substring(nowTextRef.current.length, nowTextRef.current.length + step);
      nowTextRef.current = nowText;
      setText(nowText);
      if (text.length === markdownContent.length - 1) {
        clearTimeout(timerRef.current);
      }
    }, 200);
  };

  const restart = () => {
    if (timerRef.current) clearTimeout(timerRef.current);
    timerRef.current = null;
    nowTextRef.current = '';
    setText('');
    streamOutput();
  };

  return [text, restart] as const;
};

export default () => {
  const [text, restart] = useStreamText();

  useEffect(() => {
    restart();
  }, []);

  return (
    <div style={bgStyle}>
      <button onClick={restart} type="button">
        \u91CD\u65B0\u6F14\u793A
      </button>

      <Bubble
        placement="end"
        content="\u5E2E\u6211\u53EF\u89C6\u5316\u4E00\u4E0B\u6211\u7684\u6570\u636E"
        avatar={{
          src: 'https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*2Q5LRJ3LFPUAAAAAAAAAAAAADmJ7AQ/fmt.webp',
        }}
        styles={{ content: { background: '#ebebeb' } }}
      />
      <Bubble
        content={text}
        messageRender={RenderMarkdown}
        avatar={{
          src: 'https://mdn.alipayobjects.com/huamei_je4oko/afts/img/A*6LRBT7rjOkQAAAAAAAAAAAAADsZ-AQ/original',
        }}
        variant="shadow"
        styles={{ content: { background: '#fff' } }}
      />
      <Bubble
        content={'\u751F\u6210\u8D85\u65F6\u7684\u6F14\u793A\\n' + text.substring(0, text.length - 10)}
        messageRender={RenderMarkdown}
        avatar={{
          src: 'https://mdn.alipayobjects.com/huamei_je4oko/afts/img/A*6LRBT7rjOkQAAAAAAAAAAAAADsZ-AQ/original',
        }}
        variant="shadow"
        styles={{ content: { background: '#fff' } }}
      />
    </div>
  );
};
`}}]);
